<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="Tectonics.js is a 3d plate tectonics simulator written in pure javascript that allows you to create realistic fantasy worlds from your web browser. " />
    <meta name="keywords" content="Tectonics, Simulation, 3D, World Building, Terrain Generation, Procedural Generation, Plate Tectonics, Continental Drift, Modeling, Earth Science, Open Source, Software, Development, Developers, Projects, Downloads, Github, Carl Davidson" />
    <title>Tectonics.js: 3D Plate Tectonics in your web browser</title>
    <link href="blog.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    {% include header.html %}
    {% include ads.html %}
    <div class="article bright">
        <h3 style="text-align:center">To see the model for yourself, <a href="http://davidson16807.github.io/tectonics.js">click here</a></h3>
        <h2>ABOUT</h2>
        <p>Tectonics.js is a 3d plate tectonics simulator written in pure javascript that allows you to create realistic fantasy worlds from your web browser. </p>
        <p>Tectonics.js is a principled model. It aims to use simple yet scientifically defensible models that may be easily understood by nonexperts and modified by developers. A 3D framework is used to provide a solid foundation for modeling that is grounded in reality. Javascript is used so that the model is made available to anyone through a modern web browser.</p>
        <p>The model is open source and licensed under version 2.0 of the Creative Commons <a href="http://creativecommons.org/licenses/by-nc/2.0/">Non Commercial Attribution</a> License.</p>
        <h2>NEWS</h2>
A new spin off simulator has emerged, [tectonics.js](http://davidson16807.github.io/tectonics.js/)!

This project goes one step further than pyTectonics - the project is intended to eventually implement all the features of pyTectonics, but in addition it will run in any modern web browser without requiring the installation of software. 

For those of you not wanting to scroll to the bottom, you can check out the simulation [here](http://davidson16807.github.io/tectonics.js).

The project is the culmination of lessons learned over the course of developing pyTectonics. Foremost, I've learned that libraries are inimical to wide audiences. In developing pyTectonics, it was still intended to keep library requirements to a minimum. 3d simulation was the stated goal from the very beginning, and Vpython was essential to this end. However, there is also a good deal of computation involved in a 3d simulation. Sometimes keeping libraries down to a minimum came with painful compromise. It would be nice to use an off the shelf library to handle spherical coordinates, common geodetic tasks, or maybe even implement fibonacci grids, but bundling together distributions with all of these even for a single operating system is a hassle and no one is going to go about installing these packages to see an application that remains a work in progress. There were a few libraries out there that are common enough to suspect python enthusiasts would already have - Scipy and Numpy are great examples - but even this brings your requirements up to 3 libraries. Even in the best case scenario, some users still need to be convinced to download Python. This, I've learned, can still be a harrowing experience for some users. Having to tell them to get the right version of Python doesn't help.

With web apps it isn't like this at all. Any user can click a link. Issues concerning compatibility with IE are trivial in comparison - being asked to use a different browser is a much different experience from being asked to install python and some libraries you've never heard about. Any libraries you need can be imported with impunity. I use this advantage with extreme prejudice - already the simulation is working with [underscore.js](http://underscorejs.org/), as well as libraries implementing [kd trees](https://code.google.com/p/kdtree/), [data structures](https://github.com/mauriciosantos/buckets), and [random number generators](http://simjs.com/random.html).

The second lesson learned concerns efficiency. PyTectonics started under the assumption that a lot changed since the days of SimEarth, the project's spiritual predecessor. A new simulator could make no compromise on readability and still deliver adequate performance for the user, if only through concentrating on the efficiency of algorithms. This turns out to be only partially true. PyTectonics as it currently stands delivers arguably adequate performance and code remains pythonic. Oftentimes, the most readable solution has turned out to double as the most efficient solution, as well. However, a problem arises when one considers the algorithmic shenanigans going on in order for python to perform adequately. A good example of this is in detecting plate borders so that collision detection can occur efficiently - a single list is created for each plate on initialization and that list is added to or detracted from whenever the plate changes shape. Every individual line of code is fairly readable in the process, but collectively the model is convoluted by a lot of functions that don't do much of anything besides saving runtime. I've come to the conclusion this ultimately hinders understanding. What's more, the increased mental overhead makes it increasingly difficult to debug and build upon.

The move to pure javascript for the sake of efficiency sounds counterintuitive. It's not. As it turns out, javascript on some modern web browsers is around [five times faster](http://dvschroeder.blogspot.com/2013/07/java-vs-javascript-vs-python.html) than python. Here's a figure reproduced from the study:

![Python performance](http://2.bp.blogspot.com/-BcemgfpuSvQ/UfCyESwcPKI/AAAAAAAAA9Q/a2qKDpvmZN8/s400/LatticeBoltzmannPerformanceGraph.png)

These tests were conducted on intense matrix operations, something very similar to what pyTectonics and company have to deal with. Even Safari offers speed comparable to python, according to these same tests. Based upon what's been implemented so far in javascript, I'd have to agree. At the moment, my private development branch has loosely implemented both rifting and collision in javascript. These two operations from my experience in Python have taken up the majority of runtime. The time it takes to complete these operations varies strongly with the number of grid cells simulated by the application. At approximately 6000 grid cells, my python implementation maybe updates once every second. Threading is what prevents this implementation from becoming unresponsive to user input. Compare this to the javascript implementation, running in Chrome on the same machine - I can run around 10,000 grid cells in a simulation and still get a framerate of 20 fps, no threading whatsoever. I haven't even considered the savings made once threading is taken into consideration, but rest assured that feature will come at some point. 

Certain workarounds I mentioned before, such as caching plate borders, have still not been implemented. I really don't care to do so. On the other hand, I've noticed things while re-implementing that could be done to improve performance without adding complexity to the simulation. It helps to have a robust 3d library like three.js to back you up. A good example is when geometries are updated. PyTectonics represents landmass as convex hulls that were partly occluded by the oceans. If crust rose out from the water, you would removed the object and created a new object with geometry reflecting the change. This was done every frame. Switching out objects was the only operation permitted by VPython, but with three.js, I have the option to manipulate individual vertices. Every plate starts out as an icosahedron and I push out vertices based on whether or not they should be above or below the water. I don't doubt some of the efficiency improvements may have come from this.

There is only one caveat: tectonics.js will have to be run in a *modern* browser. Internet explorer 6 doesn't count, and frankly I'm not sure about any version of internet explorer. If there are any issues with even the most recent version of IE I won't hesitate to drop support for it. 

To see the simulator for yourself, just click [here](http://davidson16807.github.io/tectonics.js)
    </div>
</body>
</html>
